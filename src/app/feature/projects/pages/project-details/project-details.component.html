<nav class="text-sm mb-4">
  <a routerLink="/projects" class="underline">Projects</a>
  <span class="opacity-60"> / </span>
  <span>{{ projectsStore.selected()?.name || 'Project' }}</span>
</nav>

<div class="flex items-center justify-between mb-4">
  <h1 class="text-2xl font-bold">
    {{ projectsStore.selected()?.name || 'Project' }}
  </h1>
  <button
    type="button"
    class="btn btn-primary"
    (click)="openCreateBoardDialog()"
  >
    New board
  </button>
</div>

@if (boardsStore.error()) {
  <div class="alert alert-error mb-2">
    {{ boardsStore.error() }}
  </div>
}

@if (boardsStore.loading()) {
  <div class="mb-2">
    <span class="loading loading-spinner loading-sm"></span>
    Loading boards...
  </div>
}

<ul class="menu bg-base-200 rounded-box">
  @for (b of boardsStore.boards(); track b.id) {
    <li class="flex items-center">
      <a
        class="flex-1"
        (click)="openBoard(b)"
      >
        {{ b.name }}
      </a>

      <div class="ml-auto flex gap-2">
        <button
          type="button"
          class="btn btn-xs"
          (click)="openRenameBoardDialog(b.id, b.name)"
        >
          Rename
        </button>
        <button
          type="button"
          class="btn btn-xs btn-error"
          (click)="openDeleteBoardDialog(b)"
        >
          Delete
        </button>
      </div>
    </li>
  }
</ul>

@if (boardsStore.isEmpty()) {
  <p class="mt-2 text-sm opacity-70">
    No boards yet. Create the first one!
  </p>
}

<app-confirm-dialog
  [open]="isDeleteBoardDialogOpen()"
  title="Delete board"
  [message]="deleteBoardMessage()"
  confirmLabel="Delete"
  cancelLabel="Cancel"
  [destructive]="true"
  (confirmed)="confirmDeleteBoard()"
  (cancelled)="cancelDeleteBoard()"
></app-confirm-dialog>

<app-name-dialog
  [open]="isBoardNameDialogOpen()"
  [title]="boardNameDialogTitle()"
  label="Board name"
  [name]="editingBoardName()"
  [confirmLabel]="boardNameDialogConfirmLabel()"
  cancelLabel="Cancel"
  (confirmed)="handleBoardNameConfirmed($event)"
  (cancelled)="cancelBoardNameDialog()"
></app-name-dialog>
